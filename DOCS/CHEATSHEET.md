# 框架速查卡

```
╔══════════════════════════════════════════════════════════════════════════════╗
║                           Unity 框架速查卡                                    ║
║                              v2.0.0                                           ║
╚══════════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────────┐
│                              核心模块概览                                     │
├──────────────┬──────────────────────────────────────────────────────────────┤
│   模块        │                        功能                                  │
├──────────────┼──────────────────────────────────────────────────────────────┤
│ Singleton    │ 单例模式管理 (BaseManager, SingletonAutoMono)                  │
│ Mono         │ 帧更新事件 (Update, FixedUpdate, LateUpdate)                   │
│ Timer        │ 定时任务管理                                                  │
│ Pool         │ 对象池 (GameObject + IPoolObject)                              │
│ EventCenter  │ 事件系统 (观察者模式)                                         │
│ UI           │ 面板管理 (显示/隐藏/层级)                                      │
│ Res          │ Resources资源加载                                             │
│ AB           │ AssetBundle加载                                              │
│ Music        │ 背景音乐 + 音效                                               │
│ Input        │ 键盘/鼠标输入                                                 │
│ Scene        │ 场景切换                                                      │
│ UWQ          │ 网络请求 (UnityWebRequest)                                    │
│ Util         │ 数学、字符串、加密工具                                        │
└──────────────┴──────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                            单例使用方式                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  非MonoBehaviour:                                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ public class MyMgr : BaseManager<MyMgr> { }                         │   │
│  │ MyMgr.Instance.DoSomething();                                       │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  MonoBehaviour (推荐):                                                      │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ public class MyMonoMgr : SingletonAutoMono<MyMonoMgr> { }          │   │
│  │ MyMonoMgr.Instance.DoSomething();                                   │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                           资源加载对比                                        │
├──────────────────────────┬──────────────────────────────────────────────────┤
│       ResMgr             │                  ABMgr                           │
├──────────────────────────┼──────────────────────────────────────────────────┤
│ Resources.Load<T>()      │ ABMgr.LoadResAsync<T>(ab, res, callback)         │
│ 同步加载，小资源          │ 异步加载，大资源，支持热更新                       │
├──────────────────────────┴──────────────────────────────────────────────────┤
│                                                                             │
│  异步加载示例:                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ ResMgr.Instance.LoadAsync<GameObject>("Prefabs/Player", (prefab)=> │   │
│  │ { Instantiate(prefab); });                                          │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                           对象池使用                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  1. 预制体挂载 PoolObj + 实现 IPoolObject                                    │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ public class Bullet : MonoBehaviour, IPoolObject {                  │   │
│  │     public void ResetInfo() { gameObject.SetActive(false); }        │   │
│  │ }                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  2. 使用对象池                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ // 获取                                                                │   │
│  │ Bullet bullet = PoolMgr.Instance.GetObj<Bullet>("Bullet");          │   │
│  │                                                                        │   │
│  │ // 使用                                                                │   │
│  │ bullet.transform.position = spawnPos;                                │   │
│  │ bullet.gameObject.SetActive(true);                                   │   │
│  │                                                                        │   │
│  │ // 归还                                                                │   │
│  │ PoolMgr.Instance.PushObj(bullet);                                    │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                           事件系统使用                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  1. 定义事件类型                                                            │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ public enum E_EventType { E_Score_Add, E_Player_Dead }              │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  2. 注册监听                                                               │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ EventCenter.Instance.AddEventListener<int>(E_EventType.E_Score_Add, │   │
│  │     (score) => { Debug.Log($"得分: {score}"); });                   │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  3. 触发事件                                                               │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ EventCenter.Instance.EventTrigger<int>(E_EventType.E_Score_Add, 100);│   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  4. 移除监听                                                               │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ EventCenter.Instance.RemoveEventListener<int>(...);                 │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                           定时器使用                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  创建定时器 (单位: 毫秒)                                                     │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ int timerId = TimerMgr.Instance.CreateTimer(                        │   │
│  │     isRealTime: false,       // false=受timeScale影响              │   │
│  │     allTime: 5000,           // 总时间 5000ms = 5秒                 │   │
│  │     overCallBack: () => { },   // 结束回调                          │   │
│  │     intervalTime: 1000,       // 间隔时间 1000ms = 1秒              │   │
│  │     callBack: () => { });     // 间隔回调                           │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  定时器控制                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ TimerMgr.Instance.StartTimer(timerId);    // 启动                   │   │
│  │ TimerMgr.Instance.StopTimer(timerId);     // 暂停                  │   │
│  │ TimerMgr.Instance.ResetTimer(timerId);    // 重置                  │   │
│  │ TimerMgr.Instance.RemoveTimer(timerId);   // 移除                  │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                           UI面板使用                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  1. 继承BasePanel                                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ public class MyPanel : BasePanel {                                  │   │
│  │     protected override void Awake() { base.Awake(); }              │   │
│  │     public override void ShowMe() { gameObject.SetActive(true); }  │   │
│  │     public override void HideMe() { gameObject.SetActive(false); } │   │
│  │ }                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  2. 获取控件                                                                │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ Button btn = GetControl<Button>("StartBtn");                       │   │
│  │ Slider slider = GetControl<Slider>("VolumeSlider");                │   │
│  │ Text text = GetControl<Text>("ScoreText");                         │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  3. 使用面板                                                                │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ UIMgr.Instance.ShowPanel<MyPanel>(E_UILayer.Middle);               │   │
│  │ UIMgr.Instance.HidePanel<MyPanel>();                               │   │
│  │ UIMgr.Instance.HidePanel<MyPanel>(true);  // 销毁                   │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  UI层级: Bottom < Middle < Top < System                                     │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                           场景切换                                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  同步: SceneMgr.Instance.LoadScene("SceneName", callback);                 │
│  异步: SceneMgr.Instance.LoadSceneAsyn("SceneName", callback);             │
│                                                                             │
│  监听进度: EventCenter.Instance.AddEventListener<float>(                    │
│      E_EventType.E_SceneLoadChange, (progress) => { });                    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                           常用工具                                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  MathUtil:                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ MathUtil.Deg2Rad(45f);          // 角度转弧度                       │   │
│  │ MathUtil.GetObjDistanceXZ(p1, p2);  // XZ平面距离                   │   │
│  │ MathUtil.RayCast(ray, callback, distance, layerMask);              │   │
│  │ MathUtil.OverlapSphere(center, radius, layerMask, callback);       │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  TextUtil:                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ TextUtil.SplitStr("a;b;c", 1);     // 分号分割                      │   │
│  │ TextUtil.GetNumStr(5, 3);          // "005"                         │   │
│  │ TextUtil.GetDecimalStr(3.14f, 2);  // "3.14"                        │   │
│  │ TextUtil.SecondToHMS(3661);        // "1时1分1秒"                   │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  EncryptionUtil:                                                            │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ int key = EncryptionUtil.GetRandomKey();                            │   │
│  │ int encrypted = EncryptionUtil.LockValue(100, key);                │   │
│  │ int decrypted = EncryptionUtil.UnLoackValue(encrypted, key);       │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                           清理清单                                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  场景切换时调用:                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ EventCenter.Instance.Clear();         // 清理事件                   │   │
│  │ TimerMgr.Instance.Stop();             // 停止定时器                 │   │
│  │ MusicMgr.Instance.ClearSound();       // 清理音效                   │   │
│  │ PoolMgr.Instance.ClearPool();         // 清理对象池                 │   │
│  │ ResMgr.Instance.UnloadUnusedAssets(); // 卸载资源                   │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  组件销毁时调用:                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ EventCenter.Instance.RemoveEventListener(...);  // 移除事件监听      │   │
│  │ MonoMgr.Instance.RemoveUpdateListener(...);     // 移除帧更新        │   │
│  │ TimerMgr.Instance.RemoveTimer(timerId);         // 移除定时器        │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                           问题索引                                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  单例为null        → 检查Instance访问时机                                    │
│  事件不触发        → 检查事件类型、监听注册、EventTrigger调用                 │
│  对象池不工作      → 检查预制体路径、PoolObj挂载、maxNum设置                 │
│  资源加载失败      → 检查路径、大小写、类型、资源位置                         │
│  定时器不执行      → 检查是否启动、isRealTime参数、场景切换                   │
│  UI控件为null      → 检查控件名称、BasePanel.Awake、面板激活状态              │
│  内存泄漏          → 检查事件、定时器、对象池、资源的清理                      │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                          性能优化要点                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  1. 频繁创建的对象使用对象池                                                 │
│  2. 定时任务使用TimerMgr而非Update                                          │
│  3. 模块间通信使用事件系统                                                   │
│  4. 大型资源使用异步加载                                                     │
│  5. 场景切换时及时清理                                                       │
│  6. 避免在Update中分配大量内存                                               │
│  7. 使用对象池预热减少运行时的GC                                             │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

═══════════════════════════════════════════════════════════════════════════════
                              框架目录结构
═══════════════════════════════════════════════════════════════════════════════

Framework/
├── AB/           Asset Bundle管理
├── EditorRes/    编辑器资源
├── EventCenter/  事件系统
├── Input/        输入管理
├── Mono/         Mono工具
├── Music/        音频管理
├── Pool/         对象池
├── Res/          资源管理
├── Scene/        场景管理
├── Singleton/    单例模式
├── Timer/        定时器
├── UI/           UI管理
├── UWQ/          网络请求
├── Util/         工具类
└── DOCS/         文档
    ├── 0_README.md        文档索引
    ├── README.md          使用指南
    ├── API_REFERENCE.md   API参考
    ├── PATTERNS_EXAMPLES.md 模式与示例
    ├── TROUBLESHOOTING.md 故障排除
    ├── CHANGELOG.md       更新日志
    └── examples/          示例代码
        └── SimpleGame.cs  完整游戏示例

═══════════════════════════════════════════════════════════════════════════════